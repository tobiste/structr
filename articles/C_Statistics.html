<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>3. Statistics of orientation data • structr</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="3. Statistics of orientation data">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">structr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.2.9002</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/A_Basics.html">1. Basics</a></li>
    <li><a class="dropdown-item" href="../articles/B_Import.html">2. Import data</a></li>
    <li><a class="dropdown-item" href="../articles/C_Plots.html">4. Orientation plots</a></li>
    <li><a class="dropdown-item" href="../articles/C_Statistics.html">3. Statistics of orientation data</a></li>
    <li><a class="dropdown-item" href="../articles/D_Plots_ggplot.html">5. Orientation plots with ggplot</a></li>
    <li><a class="dropdown-item" href="../articles/E_Faults.html">6. Faults</a></li>
    <li><a class="dropdown-item" href="../articles/F_Mohr_Circle.html">7. Mohr Circle</a></li>
    <li><a class="dropdown-item" href="../articles/G_Oriented_Drill_Cores.html">8. Oriented drill cores</a></li>
    <li><a class="dropdown-item" href="../articles/H_Strain_Analysis.html">9. Strain and Vorticity Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/I_Regression.html">10. Regression</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/tobiste/structr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>3. Statistics of orientation data</h1>
                        <h4 data-toc-skip class="author">Tobias
Stephan</h4>
            
            <h4 data-toc-skip class="date">2025-10-28</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/tobiste/structr/blob/main/vignettes/C_Statistics.Rmd" class="external-link"><code>vignettes/C_Statistics.Rmd</code></a></small>
      <div class="d-none name"><code>C_Statistics.Rmd</code></div>
    </div>

    
    
<p>This tutorial describes how to calculate basic statistics for
spherical orientation data using the <a href="https://tobiste.github.io/structr/">structr</a> package. It
covers the calculation of mean orientations, dispersion measures,
hypothesis testing, orientation tensors, and clustering of orientation
data.</p>
<p>Load the package:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tobiste.github.io/structr/">structr</a></span><span class="op">)</span></span></code></pre></div>
<p>To start, we import some example planes and lines, and convert them
to spherical objects:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">example_planes_df</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">example_lines_df</span><span class="op">)</span></span>
<span></span>
<span><span class="va">planes</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/classes.html">Plane</a></span><span class="op">(</span><span class="va">example_planes_df</span><span class="op">$</span><span class="va">dipdir</span>, <span class="va">example_planes_df</span><span class="op">$</span><span class="va">dip</span><span class="op">)</span></span>
<span><span class="va">lines</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/classes.html">Line</a></span><span class="op">(</span><span class="va">example_lines_df</span><span class="op">$</span><span class="va">trend</span>, <span class="va">example_lines_df</span><span class="op">$</span><span class="va">plunge</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="mean-and-dispersion">Mean and dispersion<a class="anchor" aria-label="anchor" href="#mean-and-dispersion"></a>
</h2>
<p>Arithmetic mean, geodesic mean, and projected mean</p>
<div class="section level3">
<h3 id="arithmetic-mean-and-variance">Arithmetic mean and variance<a class="anchor" aria-label="anchor" href="#arithmetic-mean-and-variance"></a>
</h3>
<p>The arithmetic mean orientation of spherical data is calculated by
summing up all orientation vectors and normalizing the resulting
vector.</p>
<p>In geology, the statistical estimators are useful for
<strong>vectorial data</strong> (<code>"Line"</code> objects) such as
lineations (e.g. mineral lineations, stretching lineations) or plunge
directions of fold axes, but less for axial data (<code>"Ray"</code>
objects) such as paleomagnetic directions or orientations of fold axes,
where the direction is not relevant.</p>
<p>These estimators are good descriptors of the concentration of the
data around the mean direction, assuming a unimodal, isotropic
distributions such as the <em>von Mises-Fisher distribution</em>.</p>
<p>Define some weights for our lines based on the quality reported for
the measurements:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">example_lines_df</span><span class="op">$</span><span class="va">quality</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">example_lines_df</span><span class="op">$</span><span class="va">quality</span><span class="op">)</span>, <span class="fl">6</span>, <span class="va">example_lines_df</span><span class="op">$</span><span class="va">quality</span><span class="op">)</span> <span class="co"># replacing NA values with 6</span></span>
<span><span class="va">line_weightings</span> <span class="op">&lt;-</span> <span class="fl">6</span> <span class="op">/</span> <span class="va">example_lines_df</span><span class="op">$</span><span class="va">quality</span></span></code></pre></div>
<p>The (weighted) arithmetic mean orientation of spherical data is:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lines_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/stats.html">sph_mean</a></span><span class="op">(</span><span class="va">lines</span>, w <span class="op">=</span> <span class="va">line_weightings</span><span class="op">)</span></span></code></pre></div>
<p>… and the (weighted) arithmetic variance</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lines_variance</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/stats.html">sph_var</a></span><span class="op">(</span><span class="va">lines</span>, w <span class="op">=</span> <span class="va">line_weightings</span><span class="op">)</span></span></code></pre></div>
<p>the (weighted) standard deviation (i.e. the 63% cone around the mean)
and the 95% confidence cone around the mean:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lines_delta</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/stats.html">delta</a></span><span class="op">(</span><span class="va">lines</span>, w <span class="op">=</span> <span class="va">line_weightings</span><span class="op">)</span></span>
<span><span class="va">lines_confangle</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/stats.html">sph_confidence_angle</a></span><span class="op">(</span><span class="va">lines</span>, w <span class="op">=</span> <span class="va">line_weightings</span><span class="op">)</span></span></code></pre></div>
<p>Taken together, this prints as</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"Variance"</span> <span class="op">=</span> <span class="va">lines_variance</span>,</span>
<span>  <span class="st">"63% cone"</span> <span class="op">=</span> <span class="va">lines_delta</span>,</span>
<span>  <span class="st">"Confidence angle"</span> <span class="op">=</span> <span class="va">lines_confangle</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;         Variance         63% cone Confidence angle </span></span>
<span><span class="co">#&gt;        0.1938084       36.2745102        6.9017035</span></span></code></pre></div>
<p>Summary stats can also be retrieved through</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">lines</span><span class="op">)</span></span>
<span><span class="co">#&gt;         azimuth          plunge        variance        68% cone confidence cone </span></span>
<span><span class="co">#&gt;      68.5127690      20.4958671       0.2168518      38.4502642       4.7492331</span></span></code></pre></div>
<p>Plotting a summary of the stats on a equal-area projection:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/stereoplot.html">stereoplot</a></span><span class="op">(</span>guides <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">lines</span>, col <span class="op">=</span> <span class="st">"lightgrey"</span>, pch <span class="op">=</span> <span class="fl">1</span>, cex <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">lines_mean</span>, col <span class="op">=</span> <span class="st">"#B63679"</span>, pch <span class="op">=</span> <span class="fl">19</span>, cex <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">lines_mean</span>, ang <span class="op">=</span> <span class="va">lines_confangle</span>, col <span class="op">=</span> <span class="st">"#E65164FF"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">lines_mean</span>, ang <span class="op">=</span> <span class="va">lines_delta</span>, col <span class="op">=</span> <span class="st">"#FB8861FF"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topright"</span>, legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Mean line"</span>, <span class="st">"95% confidence cone"</span>, <span class="st">"63% data cone"</span><span class="op">)</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#B63679"</span>, <span class="st">"#E65164FF"</span>, <span class="st">"#FB8861FF"</span><span class="op">)</span>, pch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">19</span>, <span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, cex <span class="op">=</span> <span class="fl">.75</span><span class="op">)</span></span></code></pre></div>
<p><img src="C_Statistics_files/figure-html/stat_plot-1.png" alt="Diagram showing statistical results of some example data plotted in an equal-area projection" width="700"></p>
</div>
<div class="section level3">
<h3 id="geodesic-mean-and-variance">Geodesic mean and variance<a class="anchor" aria-label="anchor" href="#geodesic-mean-and-variance"></a>
</h3>
<p>Another measure of mean and dispersion is the <em>Fréchet (geodesic
L<sup>2</sup>) mean</em> and <em>variance</em> which is based on the
angles between all data vectors.<br>
This can be visualized using the <code><a href="../reference/variance_plot.html">variance_plot()</a></code>; here
showing the (geodesic) angle distances between all lines and the first
line in the same data set:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/variance_plot.html">variance_plot</a></span><span class="op">(</span><span class="va">lines</span>, y <span class="op">=</span> <span class="va">lines</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p><img src="C_Statistics_files/figure-html/variance-1.png" alt="Diagram showing the distances of a set of vectors to a specified vector" width="700"></p>
<blockquote>
<p>The Fréchet mean is the vector that minimizes the sum of the squared
angle distances to all data vectors. The Fréchet variance about this
mean is the sum of the squared angle distances between all data vectors
and the Fréchet mean.</p>
</blockquote>
<p>To find the Fréchet mean vector, the algorithm iteratively searches
for the vector by using a numerical optimization method to minimize the
distances to all other vectors</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Mean</span></span>
<span><span class="fu"><a href="../reference/geodesic-mean.html">geodesic_mean</a></span><span class="op">(</span><span class="va">lines</span><span class="op">)</span></span>
<span><span class="co">#&gt; Line object (n = 1):</span></span>
<span><span class="co">#&gt;  azimuth   plunge </span></span>
<span><span class="co">#&gt; 69.64018 14.87713</span></span>
<span></span>
<span><span class="co"># Variance</span></span>
<span><span class="fu"><a href="../reference/geodesic-var.html">geodesic_var</a></span><span class="op">(</span><span class="va">lines</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.06118261</span></span></code></pre></div>
<p>These estimators are good descriptors of the concentration of the
data around the mean direction, when data follows a unimodal,
anisotropic distributions such as the <em>Kent</em> or <em>Bingham
distributions</em>.</p>
</div>
<div class="section level3">
<h3 id="projected-mean">Projected mean<a class="anchor" aria-label="anchor" href="#projected-mean"></a>
</h3>
<p>The Eigenvector with the largest Eigenvalue represents a vector
parallel to the highest concentration of a population. This vector can
also be described as the <strong>projected mean</strong>. A shortcut
function for this is:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/projected_mean.html">projected_mean</a></span><span class="op">(</span><span class="va">example_lines</span><span class="op">)</span></span>
<span><span class="co">#&gt; Line object (n = 1):</span></span>
<span><span class="co">#&gt;  azimuth   plunge </span></span>
<span><span class="co">#&gt; 69.09796 14.82125</span></span></code></pre></div>
<p>These estimators are good descriptors of the concentration of the
data around the mean direction, when data follows a unimodal,
anisotropic distributions such as the <em>Kent</em> or <em>Bingham
distributions</em>.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/stereoplot.html">stereoplot</a></span><span class="op">(</span>guides <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">example_lines</span>, col <span class="op">=</span> <span class="st">"grey"</span>, pch <span class="op">=</span> <span class="fl">16</span>, cex <span class="op">=</span> <span class="fl">.7</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="fu"><a href="../reference/stats.html">sph_mean</a></span><span class="op">(</span><span class="va">example_lines</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"#1D1147FF"</span>, pch <span class="op">=</span> <span class="fl">16</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="fu"><a href="../reference/geodesic-mean.html">geodesic_mean</a></span><span class="op">(</span><span class="va">example_lines</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"#B63679FF"</span>, pch <span class="op">=</span> <span class="fl">16</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="fu"><a href="../reference/projected_mean.html">projected_mean</a></span><span class="op">(</span><span class="va">example_lines</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"#FEC287FF"</span>, pch <span class="op">=</span> <span class="fl">16</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/title.html" class="external-link">title</a></span><span class="op">(</span>main <span class="op">=</span> <span class="st">'Lines'</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"bottomleft"</span>,</span>
<span>       legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Arithmetic mean"</span>, <span class="st">"Geodesic mean"</span>, <span class="st">"Projected mean"</span><span class="op">)</span>,</span>
<span>       col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#1D1147FF"</span>, <span class="st">"#B63679FF"</span>, <span class="st">"#FEC287FF"</span><span class="op">)</span>,</span>
<span>       pch <span class="op">=</span> <span class="fl">16</span>,</span>
<span>       bg <span class="op">=</span> <span class="st">'white'</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/stereoplot.html">stereoplot</a></span><span class="op">(</span>guides <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">example_planes</span>, col <span class="op">=</span> <span class="st">"grey"</span>, pch <span class="op">=</span> <span class="fl">16</span>, cex <span class="op">=</span> <span class="fl">.7</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="fu"><a href="../reference/stats.html">sph_mean</a></span><span class="op">(</span><span class="va">example_planes</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"#1D1147FF"</span>, pch <span class="op">=</span> <span class="fl">16</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="fu"><a href="../reference/geodesic-mean.html">geodesic_mean</a></span><span class="op">(</span><span class="va">example_planes</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"#B63679FF"</span>, pch <span class="op">=</span> <span class="fl">16</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="fu"><a href="../reference/projected_mean.html">projected_mean</a></span><span class="op">(</span><span class="va">example_planes</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"#FEC287FF"</span>, pch <span class="op">=</span> <span class="fl">16</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/title.html" class="external-link">title</a></span><span class="op">(</span>main <span class="op">=</span> <span class="st">'Planes'</span><span class="op">)</span></span></code></pre></div>
<p><img src="C_Statistics_files/figure-html/mean_plot-1.png" alt="Equal area projections showing the different estimators of the mean" width="700"></p>
</div>
<div class="section level3">
<h3 id="hypothesis-testing">Hypothesis testing<a class="anchor" aria-label="anchor" href="#hypothesis-testing"></a>
</h3>
<p>To test if a line represents the population mean of a given set of
lineations, we need to calculate the confidence region of our
population.</p>
<p>Let’s test the hypothesis that a horizontal lineation trending
towards 70° is the mean for our lineations.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">line_NULL</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/classes.html">Line</a></span><span class="op">(</span><span class="fl">70</span>, <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<p>The 95% confidence interval (from 10,000 bootstrap samples):</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ce</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/confidence_ellipse.html">confidence_ellipse</a></span><span class="op">(</span><span class="va">lines</span>, n <span class="op">=</span> <span class="fl">10000</span>, alpha <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span></code></pre></div>
<p>To visualize the confidence region of our lines:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">lines</span>, col <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/stereo_confidence.html">stereo_confidence</a></span><span class="op">(</span><span class="va">ce</span>, col <span class="op">=</span> <span class="st">"#B63679FF"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">line_NULL</span>, col <span class="op">=</span> <span class="st">"#000004"</span>, pch <span class="op">=</span> <span class="fl">16</span><span class="op">)</span></span></code></pre></div>
<p><img src="C_Statistics_files/figure-html/test2-1.png" alt="Diagram showing the confidence region of a mean" width="700"></p>
<p>The p-value for our hypothesis line:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ce</span><span class="op">$</span><span class="fu">pvalue.FUN</span><span class="op">(</span><span class="va">line_NULL</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0</span></span></code></pre></div>
<p>With (95% confidence) we rejected the Null Hypothesis that the given
line represents the population mean as the p-value is smaller than
5%.</p>
</div>
</div>
<div class="section level2">
<h2 id="orientation-tensor">Orientation tensor<a class="anchor" aria-label="anchor" href="#orientation-tensor"></a>
</h2>
<div class="section level3">
<h3 id="eigenvectors">Eigenvectors<a class="anchor" aria-label="anchor" href="#eigenvectors"></a>
</h3>
<p>The orientation tensor (Scheidegger 1965) is a matrix comprising the
mean direction cosines of the orientation vectors. In case of a Bingham
distribution, the <strong>Eigenvectors</strong> of this tensor describe
the orientation of the most dense, intermediate and least dense
orientation, and thus, are used to determine the orientation of
girdle-distributed vectors (e.g. folded planes).</p>
<div class="section level4">
<h4 id="shape-parameters">Shape parameters<a class="anchor" aria-label="anchor" href="#shape-parameters"></a>
</h4>
<p>There are more shape parameters using different algorithms based on
the orientation tensor:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/strain_shape.html">or_shape_params</a></span><span class="op">(</span><span class="va">planes</span><span class="op">)</span></span>
<span><span class="co">#&gt; $stretch_ratios</span></span>
<span><span class="co">#&gt;      Rxy      Ryz      Rxz </span></span>
<span><span class="co">#&gt; 1.478428 1.873104 2.769250 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $strain_ratios</span></span>
<span><span class="co">#&gt;       e12       e13       e23 </span></span>
<span><span class="co">#&gt; 0.3909795 1.0185765 0.6275970 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Vollmer</span></span>
<span><span class="co">#&gt;         P         G         R         B         C         I         D </span></span>
<span><span class="co">#&gt; 0.3416388 0.4120004 0.2463608 0.7536392 2.0371530 2.4750912 0.4790938 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Flinn</span></span>
<span><span class="co">#&gt; $Flinn$k</span></span>
<span><span class="co">#&gt; [1] 0.5479625</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Flinn$d</span></span>
<span><span class="co">#&gt; [1] 0.9955924</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Ramsay</span></span>
<span><span class="co">#&gt; intensity  symmetry </span></span>
<span><span class="co">#&gt; 0.5467429 0.6229787 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Woodcock</span></span>
<span><span class="co">#&gt;  strength     shape </span></span>
<span><span class="co">#&gt; 1.0185765 0.6229787 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Watterson_intensity</span></span>
<span><span class="co">#&gt; [1] 2.351532</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Lisle_intensity</span></span>
<span><span class="co">#&gt; [1] 1.147654</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Nadai</span></span>
<span><span class="co">#&gt;      goct      eoct </span></span>
<span><span class="co">#&gt; 0.8391109 0.7266914 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Lode</span></span>
<span><span class="co">#&gt; [1] 0.2323021</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $kind</span></span>
<span><span class="co">#&gt; [1] "SSL"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $MAD</span></span>
<span><span class="co">#&gt; [1] 32.80303</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $US</span></span>
<span><span class="co">#&gt; [1] 229.5308</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Jellinek</span></span>
<span><span class="co">#&gt; [1] 2.794622</span></span></code></pre></div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="cluster-vectors">Cluster vectors<a class="anchor" aria-label="anchor" href="#cluster-vectors"></a>
</h2>
<p>To find k clusters of orientational data, the
<code><a href="../reference/sph_cluster.html">sph_cluster()</a></code> function can be used:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># generate some random vectors:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">20250411</span><span class="op">)</span></span>
<span><span class="va">x1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/vonmises-fisher.html">rvmf</a></span><span class="op">(</span><span class="fl">100</span>, mu <span class="op">=</span> <span class="fu"><a href="../reference/classes.html">Line</a></span><span class="op">(</span><span class="fl">90</span>, <span class="fl">0</span><span class="op">)</span>, k <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span>
<span><span class="va">x2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/vonmises-fisher.html">rvmf</a></span><span class="op">(</span><span class="fl">100</span>, mu <span class="op">=</span> <span class="fu"><a href="../reference/classes.html">Line</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, k <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span>
<span><span class="va">x3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/vonmises-fisher.html">rvmf</a></span><span class="op">(</span><span class="fl">100</span>, mu <span class="op">=</span> <span class="fu"><a href="../reference/classes.html">Line</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">90</span><span class="op">)</span>, k <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span>
<span><span class="va">x123</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span>, <span class="va">x3</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># cluster the vectors:</span></span>
<span><span class="va">cl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sph_cluster.html">sph_cluster</a></span><span class="op">(</span><span class="va">x123</span>, k <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># visualize the result:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x123</span>, col <span class="op">=</span> <span class="fu"><a href="../reference/colorize.html">assign_col_d</a></span><span class="op">(</span><span class="va">cl</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/colorize.html">legend_d</a></span><span class="op">(</span><span class="fu"><a href="../reference/colorize.html">assign_col_d</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">cl</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span><span class="op">)</span>, title <span class="op">=</span> <span class="st">"Cluster"</span><span class="op">)</span></span></code></pre></div>
<p><img src="C_Statistics_files/figure-html/cluster-1.png" alt="Stereoplot showing the the cluster result of an example dataset" width="700"></p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Bachmann, F., Hielscher, R., Jupp, P. E., Pantleon, W., Schaeben, H.,
&amp; Wegert, E. (2010). Inferential statistics of electron backscatter
diffraction data from within individual crystalline grains. Journal of
Applied Crystallography, 43(6), 1338–1355. <a href="https://doi.org/10.1107/S002188981003027X" class="external-link uri">https://doi.org/10.1107/S002188981003027X</a></p>
<p>Davis, J. R., &amp; Titus, S. J. (2017). Modern methods of analysis
for three-dimensional orientational data. Journal of Structural Geology,
96, 65–89. <a href="https://doi.org/10.1016/j.jsg.2017.01.002" class="external-link uri">https://doi.org/10.1016/j.jsg.2017.01.002</a></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Tobias Stephan.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
