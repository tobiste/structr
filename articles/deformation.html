<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Deformation and Velocity Gradient Tensor • structr</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Deformation and Velocity Gradient Tensor">
<meta name="description" content="Deforming orientation data over time
">
<meta property="og:description" content="Deforming orientation data over time
">
<meta property="og:image" content="https://tobiste.github.io/structr/logo.png">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">structr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.2.9003</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Basics and Import</h6></li>
    <li><a class="dropdown-item" href="../articles/Basics.html">Basics</a></li>
    <li><a class="dropdown-item" href="../articles/Import.html">Import Data</a></li>
    <li><a class="dropdown-item" href="../articles/Oriented_Drill_Cores.html">Oriented Drill Cores</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Plotting</h6></li>
    <li><a class="dropdown-item" href="../articles/Plots.html">Orientation Plots</a></li>
    <li><a class="dropdown-item" href="../articles/Plots_ggplot.html">Orientation Plots with ggplot</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Statistics</h6></li>
    <li><a class="dropdown-item" href="../articles/Statistics.html">Statistics on the Sphere</a></li>
    <li><a class="dropdown-item" href="../articles/Regression.html">Regression on the Sphere</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Faults and Stress</h6></li>
    <li><a class="dropdown-item" href="../articles/Faults.html">Faults and Paleostress</a></li>
    <li><a class="dropdown-item" href="../articles/Mohr_Circle.html">Mohr Circle</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Other</h6></li>
    <li><a class="dropdown-item" href="../articles/Strain_Analysis.html">Strain and Vorticity Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/deformation.html">Deformation and Velocity Gradient Tensor</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/tobiste/structr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Deformation and Velocity Gradient Tensor</h1>
                        <h4 data-toc-skip class="author">Tobias
Stephan</h4>
            
            <h4 data-toc-skip class="date">2025-11-06</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/tobiste/structr/blob/main/vignettes/deformation.Rmd" class="external-link"><code>vignettes/deformation.Rmd</code></a></small>
      <div class="d-none name"><code>deformation.Rmd</code></div>
    </div>

    
    
<p>This tutorial demonstrates how {structr} can be used to deform
orientation data using deformation and velocity gradient tensors. This
can be useful to simulate progressive deformation and change of
orientation. It will also demonstrate how you can combine different
deformation tensors, and how to extract other flow parameters (such as
vorticity, stretching, and dilatation).</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tobiste.github.io/structr/">structr</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="deformation-gradient-tensor">Deformation gradient tensor<a class="anchor" aria-label="anchor" href="#deformation-gradient-tensor"></a>
</h2>
<p>3D deformation gradient tensor is a matrix that linearly transforms
points. In other words it describes the changes of points in three
dimensions.</p>
<div class="section level3">
<h3 id="define-a-deformation-gradient-tensor">Define a deformation gradient tensor<a class="anchor" aria-label="anchor" href="#define-a-deformation-gradient-tensor"></a>
</h3>
<p>The deformation matrix can be defined using several ways:</p>
<ul>
<li>
<code>defgrad_by_comp()</code> creates an defined by individual
components (default is identity tensor)</li>
<li>
<code>defgrad_by_ratio()</code> creates an isochoric tensor with
axial stretches defined by strain ratios (default is identity
tensor).</li>
<li>
<code><a href="../reference/defgrad.html">defgrad_from_vectors()</a></code> creates tensor representing
rotation around the axis perpendicular to both vectors and rotate
<code>v1</code> to <code>v2</code>.</li>
<li>
<code><a href="../reference/defgrad.html">defgrad_from_axisangle()</a></code> creates tensor representing a
rigid-body rotation about an axis and an angle.</li>
<li>
<code><a href="../reference/defgrad.html">defgrad_from_pureshear()</a></code> creates an isochoric coaxial
tensor.</li>
<li>
<code><a href="../reference/defgrad.html">defgrad_from_simpleshear()</a></code> creates an isochoric
non-coaxial tensor.</li>
<li>
<code><a href="../reference/defgrad.html">defgrad_from_generalshear()</a></code> creates an isochoric
tensor, where <em>transtension</em> is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>&gt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">k&gt;1</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>γ</mi><mo>≠</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\gamma \neq 0</annotation></semantics></math>,
and <em>transpression</em> is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>&lt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">k&lt;1</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>γ</mi><mo>≠</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\gamma \neq 0</annotation></semantics></math>
(<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;Fossen, H., &amp;amp; Tikoff, B. (1993). The deformation
matrix for simultaneous simple shearing, pure shearing and volume
change, and its application to transpression-transtension tectonics.
Journal of Structural Geology, 15(3–5), 413–422. &lt;a href="https://doi.org/10.1016/0191-8141(93)90137-Y" class="external-link uri"&gt;https://doi.org/10.1016/0191-8141(93)90137-Y&lt;/a&gt;&lt;/p&gt;'><sup>1</sup></a>)</li>
<li>
<code><a href="../reference/defgrad.html">defgrad_from_dilation()</a></code> creates tensor representing the
volume change in z-direction.</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">D1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/defgrad.html">defgrad_from_generalshear</a></span><span class="op">(</span>k <span class="op">=</span> <span class="fl">2.5</span>, gamma <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">D1</span><span class="op">)</span></span>
<span><span class="co">#&gt; Deformation gradient tensor</span></span>
<span><span class="co">#&gt;      [,1]     [,2] [,3]</span></span>
<span><span class="co">#&gt; [1,]    1 1.473332  0.0</span></span>
<span><span class="co">#&gt; [2,]    0 2.500000  0.0</span></span>
<span><span class="co">#&gt; [3,]    0 0.000000  0.4</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="matrix-algebra">Matrix algebra<a class="anchor" aria-label="anchor" href="#matrix-algebra"></a>
</h3>
<p>An <em>isochoric</em> deformation tensor creates deformation without
volume change. In that case, the determinant of the matrix must be 1. In
R, this can be checked using <code><a href="https://rdrr.io/r/base/det.html" class="external-link">det()</a></code>:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/det.html" class="external-link">det</a></span><span class="op">(</span><span class="va">D1</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1</span></span></code></pre></div>
<p>The <em>inverse</em> of the tensor reverses the deformation. In R,
this can be done using <code><a href="https://rdrr.io/r/base/solve.html" class="external-link">solve()</a></code>:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/solve.html" class="external-link">solve</a></span><span class="op">(</span><span class="va">D1</span><span class="op">)</span></span>
<span><span class="co">#&gt;      [,1]       [,2] [,3]</span></span>
<span><span class="co">#&gt; [1,]    1 -0.5893326  0.0</span></span>
<span><span class="co">#&gt; [2,]    0  0.4000000  0.0</span></span>
<span><span class="co">#&gt; [3,]    0  0.0000000  2.5</span></span></code></pre></div>
<p>The <em>eigenvectors</em> of the tensor describe the orientation of
the strain ellipse, and the eigenvalues
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>
describe its shape (i.e. length of the principal axes is proportional to
the amount of stretch).</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/eigen.html" class="external-link">eigen</a></span><span class="op">(</span><span class="va">D1</span><span class="op">)</span></span>
<span><span class="co">#&gt; eigen() decomposition</span></span>
<span><span class="co">#&gt; $values</span></span>
<span><span class="co">#&gt; [1] 2.5 1.0 0.4</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $vectors</span></span>
<span><span class="co">#&gt;           [,1] [,2] [,3]</span></span>
<span><span class="co">#&gt; [1,] 0.7007364    1    0</span></span>
<span><span class="co">#&gt; [2,] 0.7134203    0    0</span></span>
<span><span class="co">#&gt; [3,] 0.0000000    0    1</span></span></code></pre></div>
<p>Deformation tensors can be combined using <em>matrix
multiplication</em>. The resulting deformation from our general-shear
deformation (D1) superimposed by our rotation (D2) is</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">D2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/defgrad.html">defgrad_from_axisangle</a></span><span class="op">(</span><span class="fu"><a href="../reference/classes.html">Line</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">90</span><span class="op">)</span>, <span class="fl">30</span><span class="op">)</span></span>
<span></span>
<span><span class="va">D12</span> <span class="op">&lt;-</span> <span class="va">D2</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">D1</span> <span class="co"># D1 is applied first</span></span></code></pre></div>
<blockquote>
<p>Matrix multiplication is <strong>not commutative</strong>, i.e.
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mn>1</mn><mo>⋅</mo><mi>D</mi><mn>2</mn><mo>≠</mo><mi>D</mi><mn>2</mn><mo>⋅</mo><mi>D</mi><mn>1</mn></mrow><annotation encoding="application/x-tex">D1 \cdot D2 \neq D2 \cdot D1</annotation></semantics></math></p>
</blockquote>
</div>
<div class="section level3">
<h3 id="transformation-using-deformation-gradient-tensor">Transformation using deformation gradient tensor<a class="anchor" aria-label="anchor" href="#transformation-using-deformation-gradient-tensor"></a>
</h3>
<p>The deformation can now be applied on some orientation data using
linear transformation:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># generate some random lineation</span></span>
<span><span class="va">xl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/vonmises-fisher.html">rvmf</a></span><span class="op">(</span><span class="fl">100</span>, mu <span class="op">=</span> <span class="fu"><a href="../reference/classes.html">Line</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">90</span><span class="op">)</span>, k <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span></span>
<span><span class="va">xl_transformed</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/vecmath.html">transform_linear</a></span><span class="op">(</span><span class="va">xl</span>, <span class="va">D1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">xl_transformed</span><span class="op">)</span></span>
<span><span class="co">#&gt; Vector (Vec3) object (n = 6):</span></span>
<span><span class="co">#&gt;                x           y         z</span></span>
<span><span class="co">#&gt; [1,] -0.10284016  0.04850097 0.3964546</span></span>
<span><span class="co">#&gt; [2,]  0.13775532  0.31523476 0.3963421</span></span>
<span><span class="co">#&gt; [3,]  0.04318670  0.24232166 0.3961172</span></span>
<span><span class="co">#&gt; [4,] -0.12970895 -0.33532970 0.3954535</span></span>
<span><span class="co">#&gt; [5,] -0.23446654 -0.31984836 0.3962864</span></span>
<span><span class="co">#&gt; [6,] -0.08260559  0.09628880 0.3957975</span></span></code></pre></div>
<p>Let’s visualize the deformation:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># The coordinate axes of our deformation tensor:</span></span>
<span><span class="va">axes</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/classes.html">Vec3</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/stereoplot.html">stereoplot</a></span><span class="op">(</span>guides <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="co"># turn off guidelines for better visibility</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">xl</span>, col <span class="op">=</span> <span class="st">"grey"</span>, pch <span class="op">=</span> <span class="fl">16</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">xl_transformed</span>, col <span class="op">=</span> <span class="st">"#B63679FF"</span>, pch <span class="op">=</span> <span class="fl">16</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">axes</span>, pch <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">axes</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span>, <span class="st">"z"</span><span class="op">)</span>, pos <span class="op">=</span> <span class="fl">1</span>, font <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"right"</span>, legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"D0"</span>, <span class="st">"D1"</span><span class="op">)</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"grey"</span>, <span class="st">"#B63679FF"</span><span class="op">)</span>, pch <span class="op">=</span> <span class="fl">16</span><span class="op">)</span></span></code></pre></div>
<p><img src="deformation_files/figure-html/transform1_plot-1.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="velocity-gradient-tensor">Velocity gradient tensor<a class="anchor" aria-label="anchor" href="#velocity-gradient-tensor"></a>
</h2>
<p>The velocity gradient tensor <strong>L</strong> describes the
velocity of particles at any instant during the deformation. Velocity
gradient tensor from deformation gradient tensor.</p>
<ul>
<li>The <code>time</code> argument specifies the time of deformation,
i.e. how many times the Deformation gradient tensor should be
applied.</li>
</ul>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">L</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gradient.html">velgrad</a></span><span class="op">(</span><span class="va">D1</span>, time <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="decomposition">Decomposition<a class="anchor" aria-label="anchor" href="#decomposition"></a>
</h3>
<p>The velocity gradient tensor <strong>L</strong> can be decomposed
into a symmetric matrix <strong>S</strong> (the strain rate or
stretching tensor) and the skew-symmetric matrix <strong>W</strong> (the
spin tensor).</p>
<p>The stretching matrix (or tensor) and describes the portion of the
deformation that over time produces strain:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">S</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/vel_rate.html">velgrad_rate</a></span><span class="op">(</span><span class="va">L</span><span class="op">)</span></span></code></pre></div>
<p>The spin tensor contains information about the internal rotation
during the deformation:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">W</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/vel_rate.html">velgrad_spin</a></span><span class="op">(</span><span class="va">L</span><span class="op">)</span></span></code></pre></div>
<p>The eigenvectors of the stretching gradient tensor give the
orientations and lengths of the <strong>instantaneous stretching
axes</strong>:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">S_eig</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/eigen.html" class="external-link">eigen</a></span><span class="op">(</span><span class="va">S</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># ISA vectors</span></span>
<span><span class="va">axes_ISA</span> <span class="op">&lt;-</span> <span class="va">S_eig</span><span class="op">$</span><span class="va">vectors</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/classes.html">as.Vec3</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/classes.html">Line</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Amounts of stretching</span></span>
<span><span class="va">S_eig</span><span class="op">$</span><span class="va">values</span></span>
<span><span class="co">#&gt; [1]  0.11003269 -0.01840362 -0.09162907</span></span></code></pre></div>
<blockquote>
<p>The shortcut functions <code>instantaneous_stretching_axes(L)</code>
and <code>instantaneous_stretching(L)</code> produce the same results as
above.</p>
</blockquote>
<p>The eigenvectors of the velocity gradient tensor describe the
<strong>flow apophyses</strong>:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">L_eig</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/eigen.html" class="external-link">eigen</a></span><span class="op">(</span><span class="va">L</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Flow apophyses</span></span>
<span><span class="va">flow_vectors</span> <span class="op">&lt;-</span> <span class="va">L_eig</span><span class="op">$</span><span class="va">vectors</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/classes.html">as.Vec3</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">flow_apophyses</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/crossprod.html" class="external-link">crossprod</a></span><span class="op">(</span><span class="va">flow_vectors</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span>, <span class="va">flow_vectors</span><span class="op">[</span><span class="fl">2</span>, <span class="op">]</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/crossprod.html" class="external-link">crossprod</a></span><span class="op">(</span><span class="va">flow_vectors</span><span class="op">[</span><span class="fl">2</span>, <span class="op">]</span>, <span class="va">flow_vectors</span><span class="op">[</span><span class="fl">3</span>, <span class="op">]</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/classes.html">Plane</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<blockquote>
<p>short cut: <code>flow_apophyses(L)</code></p>
</blockquote>
<p>The angle α between the apophyses is directly related to how close to
simple shear or pure shear the deformation is. α is zero for simple
shear and 90° for pure shear. The <strong>kinematic vorticity
number</strong>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>W</mi><mi>k</mi></msub><annotation encoding="application/x-tex">W_k</annotation></semantics></math>
is given by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>W</mi><mi>k</mi></msub><mo>=</mo><mo>cos</mo><mi>α</mi></mrow><annotation encoding="application/x-tex">W_k = \cos\alpha</annotation></semantics></math>:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/vecmath.html">angle</a></span><span class="op">(</span><span class="va">flow_apophyses</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span>, <span class="va">flow_apophyses</span><span class="op">[</span><span class="fl">2</span>, <span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">cos</a></span><span class="op">(</span><span class="va">alpha</span> <span class="op">*</span> <span class="va">pi</span> <span class="op">/</span> <span class="fl">180</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.7007364</span></span></code></pre></div>
<blockquote>
<p>short cut: <code>kinematic_vorticity_from_velgrad(L)</code></p>
</blockquote>
<p>The <strong>vorticity vector</strong> is the eigenvector
corresponding to the intermediate eigenvalue of the velocity gradient
tensor:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/classes.html">Line</a></span><span class="op">(</span><span class="va">flow_vectors</span><span class="op">[</span><span class="fl">2</span>, <span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; Line object (n = 1):</span></span>
<span><span class="co">#&gt; azimuth  plunge </span></span>
<span><span class="co">#&gt;       0      90</span></span></code></pre></div>
<blockquote>
<p>shortcut: <code>vorticity_vector(L)</code></p>
</blockquote>
</div>
<div class="section level3">
<h3 id="strain-increments">Strain increments<a class="anchor" aria-label="anchor" href="#strain-increments"></a>
</h3>
<p>Now we can extract the deformation gradient tensor accumulated after
a given time. Here we extract the deformation gradient tensors for some
time steps using <code><a href="../reference/defgrad.html">defgrad()</a></code></p>
<ul>
<li>The <code>steps</code> argument specifies how many increments you
would like to extract (this is also is the “resolution” of the
deformation path)</li>
<li>The <code>time</code>
</li>
</ul>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">D1_steps</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/defgrad.html">defgrad</a></span><span class="op">(</span><span class="va">L</span>, time <span class="op">=</span> <span class="fl">10</span>, steps <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p>Now apply the deformation tensors on some orientation data</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">xl_steps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">D1_steps</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/vecmath.html">transform_linear</a></span><span class="op">(</span><span class="va">xl</span>, <span class="va">i</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="visualization-of-deformation-over-time">Visualization of deformation over time<a class="anchor" aria-label="anchor" href="#visualization-of-deformation-over-time"></a>
</h3>
<p>And plot the paths showing how the orientations change over time</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">increments</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/colorize.html">assign_col</a></span><span class="op">(</span><span class="va">increments</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/stereoplot.html">stereoplot</a></span><span class="op">(</span>guides <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="co"># turn off guidelines for better visibility</span></span>
<span></span>
<span><span class="co"># plot the strain increments</span></span>
<span><span class="fu"><a href="../reference/stereo_path.html">stereo_path</a></span><span class="op">(</span><span class="va">xl_steps</span>, type <span class="op">=</span> <span class="st">"l"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/stereo_path.html">stereo_path</a></span><span class="op">(</span><span class="va">xl_steps</span>, type <span class="op">=</span> <span class="st">"p"</span>, col <span class="op">=</span> <span class="va">cols</span>, pch <span class="op">=</span> <span class="fl">16</span>, cex <span class="op">=</span> <span class="fl">.4</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># flow apophyses</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">flow_apophyses</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"grey30"</span>, <span class="st">"grey70"</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># instantaneous stretching axes</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">axes_ISA</span>, pch <span class="op">=</span> <span class="fl">15</span>, col <span class="op">=</span> <span class="st">"#B63679FF"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">axes_ISA</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ISA-1"</span>, <span class="st">"ISA-2"</span>, <span class="st">"ISA-3"</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"#B63679FF"</span>, pos <span class="op">=</span> <span class="fl">3</span>, font <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># coordinate axes of def-tensor</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">axes</span>, pch <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">axes</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span>, <span class="st">"z"</span><span class="op">)</span>, pos <span class="op">=</span> <span class="fl">1</span>, font <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># legend</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="fl">0</span>, <span class="op">-</span><span class="fl">1.1</span>,</span>
<span>  xjust <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Flow apophysis 1"</span>, <span class="st">"Flow apophysis 2"</span><span class="op">)</span>,</span>
<span>  col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"grey30"</span>, <span class="st">"grey70"</span><span class="op">)</span>,</span>
<span>  lty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/colorize.html">legend_c</a></span><span class="op">(</span><span class="va">increments</span>, title <span class="op">=</span> <span class="st">"Time"</span><span class="op">)</span></span></code></pre></div>
<p><img src="deformation_files/figure-html/plot_stereo-1.png" width="700"></p>
<p>We can also monitor how the orientation tensor changes during
progressive deformation:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/vollmer-plot.html">vollmer_plot</a></span><span class="op">(</span><span class="va">xl_steps</span>, type <span class="op">=</span> <span class="st">"b"</span>, col <span class="op">=</span> <span class="va">cols</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/hsu_plot.html">hsu_plot</a></span><span class="op">(</span><span class="va">xl_steps</span>, type <span class="op">=</span> <span class="st">"b"</span>, col <span class="op">=</span> <span class="va">cols</span><span class="op">)</span></span></code></pre></div>
<p><img src="deformation_files/figure-html/plot_ortensors-1.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Fossen, H., &amp; Tikoff, B. (1993). The deformation matrix for
simultaneous simple shearing, pure shearing and volume change, and its
application to transpression-transtension tectonics. Journal of
Structural Geology, 15(3–5), 413–422. <a href="https://doi.org/10.1016/0191-8141(93)90137-Y" class="external-link uri">https://doi.org/10.1016/0191-8141(93)90137-Y</a></p>
<p>Sanderson, D. J., &amp; Marchini, W. R. D. (1984). Transpression.
Journal of Structural Geology, 6(5), 449–458. <a href="https://doi.org/10.1016/0191-8141(84)90058-0" class="external-link uri">https://doi.org/10.1016/0191-8141(84)90058-0</a></p>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://tobiste.github.io/" class="external-link">Tobias Stephan</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
